<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.4//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.zhixingshidai.pachong.dao.CodeMapper">
   <select id="getCodeAttr" resultType="map">
       select goodsWordId,goodsClassId from ${tableName}
       <where>
           goodsWordId is not null
           and (newGoodClassId = 0 or newGoodClassId is null)
           and (newGoodClassStatus = 0 or newGoodClassStatus is null)
       </where>
       group by goodsWordId
   </select>

   <update id="update">
       update ${tableName}
       <set>
           <if test="goodsClassId != null">
               newGoodClassId = #{goodsClassId},
               newGoodClassStatus = 1,
               newGoodClassUpdateDate = now(),
           </if>
       </set>
       <where>
           goodsWordId =#{goodsWordId}
           and (newGoodClassId = 0 or newGoodClassId is null)
           and (newGoodClassStatus = 0 or newGoodClassStatus is null)
       </where>
   </update>

    <select id="getGoodIdByWordId" resultType="String">
        select goods_class_id from tb_word
        <where>
            word_id = #{goodsWordId}
        </where>
    </select>
    <select id="getIdByGoodClassId" parameterType="String" resultType="Integer">
        select id from tb_goods_class
        <where>
            goods_class_id = #{goodClassId}
        </where>
    </select>
</mapper>